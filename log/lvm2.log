Script started on 2020-08-13 11:27:35+03:00 [TERM="xterm-256color" TTY="/dev/pts/0" COLUMNS="86" LINES="43"]
]0;albert@albert-ubuntu: ~/otus.linux/work_with_lvm[01;32malbert@albert-ubuntu[00m:[01;34m~/otus.linux/work_with_lvm[00m$ vagrant ssh
]0;vagrant@lvm:~[?1034h[vagrant@lvm ~]$ sudo -s
]0;root@lvm:/home/vagrant[?1034h[root@lvm vagrant]# lsblk
NAME                    MAJ:MIN RM  SIZE RO TYPE MOUNTPOINT
sda                       8:0    0   40G  0 disk 
â”œâ”€sda1                    8:1    0    1M  0 part 
â”œâ”€sda2                    8:2    0    1G  0 part /boot
â””â”€sda3                    8:3    0   39G  0 part 
  â”œâ”€VolGroup00-LogVol00 253:0    0 37.5G  0 lvm  /
  â””â”€VolGroup00-LogVol01 253:1    0  1.5G  0 lvm  [SWAP]
sdb                       8:16   0   10G  0 disk 
sdc                       8:32   0    2G  0 disk 
sdd                       8:48   0    1G  0 disk 
sde                       8:64   0    1G  0 disk 
]0;root@lvm:/home/vagrant[root@lvm vagrant]# pvcreate /dev/sdc /dev/sdd
  Physical volume "/dev/sdc" successfully created.
  Physical volume "/dev/sdd" successfully created.
]0;root@lvm:/home/vagrant[root@lvm vagrant]# vgcreate vg_var /dev/sdc /dev/sdd
  Volume group "vg_var" successfully created
]0;root@lvm:/home/vagrant[root@lvm vagrant]# 
]0;root@lvm:/home/vagrant[root@lvm vagrant]# 
]0;root@lvm:/home/vagrant[root@lvm vagrant]# lvcreate -L 750M -m1 -n lv_var vg_var
  Rounding up size to full physical extent 752.00 MiB
  Logical volume "lv_var" created.
]0;root@lvm:/home/vagrant[root@lvm vagrant]# mkfs.ext4 /dev/vg_var/lv_var
mke2fs 1.42.9 (28-Dec-2013)
Filesystem label=
OS type: Linux
Block size=4096 (log=2)
Fragment size=4096 (log=2)
Stride=0 blocks, Stripe width=0 blocks
48192 inodes, 192512 blocks
9625 blocks (5.00%) reserved for the super user
First data block=0
Maximum filesystem blocks=197132288
6 block groups
32768 blocks per group, 32768 fragments per group
8032 inodes per group
Superblock backups stored on blocks: 
	32768, 98304, 163840

Allocating group tables: 0/6   done                            
Writing inode tables: 0/6   done                            
Creating journal (4096 blocks): done
Writing superblocks and filesystem accounting information: 0/6   done

]0;root@lvm:/home/vagrant[root@lvm vagrant]# mount /dev/vg_var/lv_var /mnt
]0;root@lvm:/home/vagrant[root@lvm vagrant]# cp -aR /var/* /mnt/
]0;root@lvm:/home/vagrant[root@lvm vagrant]# mkdir /tmp/oldvar && mv /var/* /tmp/oldvar
mv: cannot move â€˜/var/tmpâ€™ to â€˜/tmp/oldvar/tmpâ€™: Device or resource busy
]0;root@lvm:/home/vagrant[root@lvm vagrant]# umount /mnt
]0;root@lvm:/home/vagrant[root@lvm vagrant]# mount /dev/vg_var/lv_var /var
]0;root@lvm:/home/vagrant[root@lvm vagrant]# echo "blkid | grep var: | awk '{print $2}' /var ext4 defaults 0 0"  >> /etc/fstab
]0;root@lvm:/home/vagrant[root@lvm vagrant]# cat /etc/fstab 

#
# /etc/fstab
# Created by anaconda on Sat May 12 18:50:26 2018
#
# Accessible filesystems, by reference, are maintained under '/dev/disk'
# See man pages fstab(5), findfs(8), mount(8) and/or blkid(8) for more info
#
/dev/mapper/VolGroup00-LogVol00 /                       xfs     defaults        0 0
UUID=570897ca-e759-4c81-90cf-389da6eee4cc /boot                   xfs     defaults        0 0
/dev/mapper/VolGroup00-LogVol01 swap                    swap    defaults        0 0
blkid | grep var: | awk '{print }' /var ext4 defaults 0 0
]0;root@lvm:/home/vagrant[root@lvm vagrant]# vi [K[K[Kvivi /etc/fss[Ktab 
bash: vivi: command not found
]0;root@lvm:/home/vagrant[root@lvm vagrant]# vivi /etc/fstab [1P[1P
[?1049h[?1h=[1;43r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[43;1H"/etc/fstab" 12L, 539C[2;1H#
# /etc/fstab
# Created by anaconda on Sat May 12 18:50:26 2018
#
# Accessible filesystems, by reference, are maintained under '/dev/disk'
# See man pages fstab(5), findfs(8), mount(8) and/or blkid(8) for more info
#
/dev/mapper/VolGroup00-LogVol00 /[23Cxfs     defaults[8C0 0
UUID=570897ca-e759-4c81-90cf-389da6eee4cc /boot[19Cxfs     defaults     [11;1H    0 0
/dev/mapper/VolGroup00-LogVol01 swap[20Cswap    defaults[8C0 0
blkid | grep var: | awk '{print }' /var ext4 defaults 0 0
[94m~                                                                                     [15;1H~                                                                                     [16;1H~                                                                                     [17;1H~                                                                                     [18;1H~                                                                                     [19;1H~                                                                                     [20;1H~                                                                                     [21;1H~                                                                                     [22;1H~                                                                                     [23;1H~                                                                                     [24;1H~                                                                                     [25;1H~                                                                                     [26;1H~                                                                                     [27;1H~                                                                                     [28;1H~                                                                                     [29;1H~                                                                                     [30;1H~                                                                                     [31;1H~                                                                                     [32;1H~                                                                                     [33;1H~                                                                                     [34;1H~                                                                                     [35;1H~                                                                                     [36;1H~                                                                                     [37;1H~                                                                                     [38;1H~                                                                                     [39;1H~                                                                                     [40;1H~                                                                                     [41;1H~                                                                                     [42;1H~                                                                                     [1;1H[?12l[?25h











[mblkid | grep var: | awk '{print }' /var ext4 defaults 0 [?25l[43;1H[1m-- INSERT --[m[43;14H[K[13;57H[?12l[?25h[?25l0[13;57H[K[13;56H[?12l[?25h[?25l[13;56H[K[13;55H[?12l[?25h[?25l0[13;55H[K[13;54H[?12l[?25h[?25l0[13;54H[K[13;53H[?12l[?25h[?25l0[13;53H[K[13;52H[?12l[?25h[?25l0[13;52H[K[13;51H[?12l[?25h[?25l0[13;51H[K[13;50H[?12l[?25h[?25l0[13;50H[K[13;49H[?12l[?25h[?25l0[13;49H[K[13;48H[?12l[?25h[?25l0[13;48H[K[13;47H[?12l[?25h[?25l0[13;47H[K[13;46H[?12l[?25h[?25l0[13;46H[K[13;45H[?12l[?25h[?25l0[13;45H[K[13;44H[?12l[?25h[?25l0[13;44H[K[13;43H[?12l[?25h[?25l0[13;43H[K[13;42H[?12l[?25h[?25l0[13;42H[K[13;41H[?12l[?25h[?25l0[13;41H[K[13;40H[?12l[?25h[?25l0[13;40H[K[13;39H[?12l[?25h[?25l0[13;39H[K[13;38H[?12l[?25h[?25l0[13;38H[K[13;37H[?12l[?25h[?25l0[13;37H[K[13;36H[?12l[?25h[?25l0[13;36H[K[13;35H[?12l[?25h[?25l0[13;35H[K[13;34H[?12l[?25h[?25l0[13;34H[K[13;33H[?12l[?25h[?25l0[13;33H[K[13;32H[?12l[?25h[?25l0[13;32H[K[13;31H[?12l[?25h[?25l0[13;31H[K[13;30H[?12l[?25h[?25l0[13;30H[K[13;29H[?12l[?25h[?25l0[13;29H[K[13;28H[?12l[?25h[?25l0[13;28H[K[13;27H[?12l[?25h[?25l0[13;27H[K[13;26H[?12l[?25h[?25l0[13;26H[K[13;25H[?12l[?25h[?25l0[13;25H[K[13;24H[?12l[?25h[?25l0[13;24H[K[13;23H[?12l[?25h[?25l0[13;23H[K[13;22H[?12l[?25h[?25l0[13;22H[K[13;21H[?12l[?25h[?25l0[13;21H[K[13;20H[?12l[?25h[?25l0[13;20H[K[13;19H[?12l[?25h[?25l0[13;19H[K[13;18H[?12l[?25h[?25l0[13;18H[K[13;17H[?12l[?25h[?25l0[13;17H[K[13;16H[?12l[?25h[?25l0[13;16H[K[13;15H[?12l[?25h[?25l0[13;15H[K[13;14H[?12l[?25h[?25l0[13;14H[K[13;13H[?12l[?25h[?25l0[13;13H[K[13;12H[?12l[?25h[?25l0[13;12H[K[13;11H[?12l[?25h[?25l0[13;11H[K[13;10H[?12l[?25h[?25l0[13;10H[K[13;9H[?12l[?25h[?25l0[13;9H[K[13;8H[?12l[?25h[?25l0[13;8H[K[13;7H[?12l[?25h[?25l0[13;7H[K[13;6H[?12l[?25h[?25l0[13;6H[K[13;5H[?12l[?25h[?25l0[13;5H[K[13;4H[?12l[?25h[?25l0[13;4H[K[13;3H[?12l[?25h[?25l0[13;3H[K[13;2H[?12l[?25h[?25l0[13;2H[K[13;1H[?12l[?25h[?25l[13;1H[K[13;1H[?12l[?25h[?25l[94m~                                                                                     [12;84H[?12l[?25h[m[43;1H[K[12;83H[?25l[?12l[?25h[?25l[43;1H:[?12l[?25hwq[?25l"/etc/fstab" 11L, 481C written
[?1l>[?12l[?25h[?1049l]0;root@lvm:/home/vagrant[root@lvm vagrant]# cat [10@vi /etc/fstab[C[2@vi[C[C[C[C[C[C[C[C[C[C[C[C[1Pcat[C[C[C[C[C[C[C[C[C[C[C[C

#
# /etc/fstab
# Created by anaconda on Sat May 12 18:50:26 2018
#
# Accessible filesystems, by reference, are maintained under '/dev/disk'
# See man pages fstab(5), findfs(8), mount(8) and/or blkid(8) for more info
#
/dev/mapper/VolGroup00-LogVol00 /                       xfs     defaults        0 0
UUID=570897ca-e759-4c81-90cf-389da6eee4cc /boot                   xfs     defaults        0 0
/dev/mapper/VolGroup00-LogVol01 swap                    swap    defaults        0 0
]0;root@lvm:/home/vagrant[root@lvm vagrant]# echo "`blkid | grep var: | awk '{print $2}'` /var ext4 defaults 0  0" >> /etc/fstab
]0;root@lvm:/home/vagrant[root@lvm vagrant]# echo "`blkid | grep var: | awk '{print $2}'` /var ext4 defaults 0 00" >> /etc/fstab[A[C[C[C[Ccat /etc/fstab [K
[K[A[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C

#
# /etc/fstab
# Created by anaconda on Sat May 12 18:50:26 2018
#
# Accessible filesystems, by reference, are maintained under '/dev/disk'
# See man pages fstab(5), findfs(8), mount(8) and/or blkid(8) for more info
#
/dev/mapper/VolGroup00-LogVol00 /                       xfs     defaults        0 0
UUID=570897ca-e759-4c81-90cf-389da6eee4cc /boot                   xfs     defaults        0 0
/dev/mapper/VolGroup00-LogVol01 swap                    swap    defaults        0 0
UUID="293cd1fc-a4aa-4d53-9d5d-e43317a529fa" /var ext4 defaults 0 0
]0;root@lvm:/home/vagrant[root@lvm vagrant]# shutdown -r now
Connection to 127.0.0.1 closed by remote host.
Connection to 127.0.0.1 closed.
]0;albert@albert-ubuntu: ~/otus.linux/work_with_lvm[01;32malbert@albert-ubuntu[00m:[01;34m~/otus.linux/work_with_lvm[00m$ vagrant status
[0mCurrent machine states:

lvm                       running (virtualbox)

The VM is running. To stop this VM, you can run `vagrant halt` to
shut it down forcefully, or you can run `vagrant suspend` to simply
suspend the virtual machine. In either case, to restart it again,
simply run `vagrant up`.[0m
]0;albert@albert-ubuntu: ~/otus.linux/work_with_lvm[01;32malbert@albert-ubuntu[00m:[01;34m~/otus.linux/work_with_lvm[00m$ vagrant ssh
Last login: Thu Aug 13 08:27:45 2020 from 10.0.2.2
]0;vagrant@lvm:~[?1034h[vagrant@lvm ~]$ lsblk
NAME                     MAJ:MIN RM  SIZE RO TYPE MOUNTPOINT
sda                        8:0    0   40G  0 disk 
â”œâ”€sda1                     8:1    0    1M  0 part 
â”œâ”€sda2                     8:2    0    1G  0 part /boot
â””â”€sda3                     8:3    0   39G  0 part 
  â”œâ”€VolGroup00-LogVol00  253:0    0 37.5G  0 lvm  /
  â””â”€VolGroup00-LogVol01  253:1    0  1.5G  0 lvm  [SWAP]
sdb                        8:16   0   10G  0 disk 
sdc                        8:32   0    2G  0 disk 
â”œâ”€vg_var-lv_var_rmeta_0  253:2    0    4M  0 lvm  
â”‚ â””â”€vg_var-lv_var        253:6    0  752M  0 lvm  /var
â””â”€vg_var-lv_var_rimage_0 253:3    0  752M  0 lvm  
  â””â”€vg_var-lv_var        253:6    0  752M  0 lvm  /var
sdd                        8:48   0    1G  0 disk 
â”œâ”€vg_var-lv_var_rmeta_1  253:4    0    4M  0 lvm  
â”‚ â””â”€vg_var-lv_var        253:6    0  752M  0 lvm  /var
â””â”€vg_var-lv_var_rimage_1 253:5    0  752M  0 lvm  
  â””â”€vg_var-lv_var        253:6    0  752M  0 lvm  /var
sde                        8:64   0    1G  0 disk 
]0;vagrant@lvm:~[vagrant@lvm ~]$ exit
logout
Connection to 127.0.0.1 closed.
]0;albert@albert-ubuntu: ~/otus.linux/work_with_lvm[01;32malbert@albert-ubuntu[00m:[01;34m~/otus.linux/work_with_lvm[00m$ exit
exit

Script done on 2020-08-13 12:58:55+03:00 [COMMAND_EXIT_CODE="0"]
